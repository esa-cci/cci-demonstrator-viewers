<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Airflow Demonstrator - CCI Examples</title><meta property="og:title" content="Airflow Demonstrator - CCI Examples"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the CCI activity"/><meta property="og:description" content="Collection of examples relevant to the CCI activity"/><meta name="keywords" content=""/><link rel="stylesheet" href="/cci-demonstrator-viewers/build/_assets/app-SDGCW62C.css"/><link rel="stylesheet" href="/cci-demonstrator-viewers/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/cci-demonstrator-viewers/favicon.ico"/><link rel="stylesheet" href="/cci-demonstrator-viewers/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="myst-top-nav-menu-button flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/cci-demonstrator-viewers/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] lg:hidden hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="myst-fm-block-subject flex-none pr-2 smallcaps">CCI Examples</div><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/esa-cci/cci-notebook-viewers" title="GitHub Repository: esa-cci/cci-notebook-viewers" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/esa-cci/cci-notebook-viewers/edit/main/external_notebooks/esa-cci/ect-demonstrators/demonstrators/Airflow/README.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Airflow Demonstrator</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><p>This demonstrator has been tested on a Linux environment.</p><p>It shows how Apache Airflow can be used to run a workflow including functionality from the ESA Climate Toolbox.
As stated on their <a target="_blank" rel="noreferrer" href="https://airflow.apache.org/" class="">website</a>, Apache Airflow is a platform created by the community to programmatically author, schedule and monitor workflows.
Workflows are defined once and may be rerun multiple times.
They come in the form of Directed Acyclic Graphs (DAGs).
For this demonstrator, we have set up such a dag, which can be seen in the file <code>dag_config.yaml</code> in the dags folder.
You can read more about specifics of how a configuration file can be set up <a href="https://github.com/bcdev/gaiaflow/blob/main/%7B%7B%20cookiecutter.folder_name%20%7D%7D/dags/change_me_config.yml" class="italic" target="_blank" rel="noreferrer" data-state="closed">here</a>.
We explain the particularities of the DAG in the following section, if you want to run the demonstrator immediately, go to <a target="_blank" rel="noreferrer" href="(#prerequisites-to-run-the-demonstrator)" class="">Prerequisites</a>.</p><h2 id="the-directed-acyclic-graph-dag" class="relative group"><span class="heading-text">The Directed Acyclic Graph (DAG)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#the-directed-acyclic-graph-dag" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The dag is specified in the section <code>esa_climate_toolbox_ops_dag</code>. This is the name under which the dag will later be found in the UI.</p><p>In this section, there are sub-sections <code>task_groups</code> and <code>tasks</code>.
Task Groups are helpful to group tasks, which can come in handy for large processes.
Here, we only specify one group, <code>ect_tasks</code>.
In <code>tasks</code>, we dfine the actual sub processes.
There are three of them:</p><ul><li><p><code>chain</code> runs a chain of ESA Climate Toolbox Operations on a dataset and writes the result to disk</p></li><li><p><code>plot</code> creates a plot from this result</p></li><li><p><code>delete_folder</code> deletes the folder that included the data written by the <code>chain</code> task</p></li></ul><p>Tasks <code>chain</code> and <code>plot</code> are Python tasks - and hence use a PythonOperator - whilst <code>delete_folder</code> merely executs a bash command, so it uses a <code>BashOperator</code>, as can be seen in the respective task’s entries for the field <code>operator</code>.
Besides these, there is a large sum of operators, many of whom have been designed to cater to specific tasks (if you are interested, you can find a full list <a target="_blank" rel="noreferrer" href="https://registry.astronomer.io/modules?typeName=Operators&amp;_gl=1*1s3aunx*_up*MQ..*_ga*NTEyMzEyNy4xNzQ3ODMyNDM2*_ga_W97HK48NPT*czE3NDc4MzI0MzUkbzEkZzAkdDE3NDc4MzI0MzUkajAkbDAkaDA.*_ga_14DHW7X721*czE3NDc4MzI0MzUkbzEkZzAkdDE3NDc4MzI0MzUkajAkbDAkaDA." class="">here</a>).</p><p>Python operators must point to a specific Python function. This function can either be provided by a package (as is the case in the <code>chain</code> task, where we point to the <code>execute_operations</code> function from the ESA CCI Toolbox, which allows to run multiple operations consecutively (and which is documented <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.core.execute_operations" class="">here</a>)) or as a dedicated Python function, which we did for the <code>plot</code> task, where the function <code>plot_chain_output</code> is provided in the module <code>plot_functions.py</code> in the <code>dags/functions</code> folder.
Note that it would have been possible to add the plotting operation to the chain, but for the purposes of this demonstrator, we wanted to show two different approaches.
Both Python operators receive their parameters from the <code>op_kwargs</code> sections in the tasks.
For the <code>chain</code> task, you see that we pick an aerosol dataset as input, create temporal, spatial, and thematic subsets, and ultimately write the result to an output_folder.
This provides a way to run ESA Climate Toolbox operations without interacting with Python directly.
For the <code>plot</code> task, we pick one of the variables of the dataset to plot and pick a name for the output file (for visualisation purposes, we here choose a region that is slightly larger than the subset region defined in <code>chain</code>).
What’s further of importance to point out for the tasks is that it is here where we specify the pertinence of a task to a task group (in <code>task_group_name</code>) and define dependencies between tasks in dependencies.
The dependency <code>[ chain ]</code> in <code>plot</code> says that the task <code>plot</code> will not start before the task <code>chain</code> has finished.
Finally, <code>do_xcom_push</code> is set to False, which means that no information is passed between tasks.</p><p>The last task, <code>delete_folder</code>, ultimately executes the bash command which deletes the folder with the output from <code>chain</code>. Remove this task if you want to keep the result.</p><h2 id="prerequisites-to-run-the-demonstrator" class="relative group"><span class="heading-text">Prerequisites to run the Demonstrator</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prerequisites-to-run-the-demonstrator" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>To run this demonstrator, you need mamba (from <a target="_blank" rel="noreferrer" href="https://github.com/conda-forge/miniforge" class="">here</a>), alternatively conda.
When you have mamba configured, you can create a dedicated environment using the provided file <code>environment.yml</code>.
To do that, run</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-shell" style="white-space:pre">    mamba env create -f environment.yml</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>This will install all the libraries required.
Next, export the following environment variables</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-shell" style="white-space:pre">    export AIRFLOW_HOME=$(pwd)
    export AIRFLOW__CORE__LOAD_EXAMPLES=false</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>The first one will make the current folder the working directory, so that all outputs are written there.
The second one will prevent other dags from being loaded in, which makes it easier to keep an overview.
Next, switch to the environment you had just created.</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-shell" style="white-space:pre">    mamba activate airflow-ect</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>You can now run Airflow as a stand-alone server.</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-shell" style="white-space:pre">    airflow standalone</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Running this will create a long output. In this output, you will find a username (which is admin) and a password which changes on every restart.
Also, this will start an airflow server available at <a target="_blank" rel="noreferrer" href="http://0.0.0.0:8080" class="">http://0.0.0.0:8080</a> .
Open this address in your browser, where you will be asked for the username and password.
After providing the credentials, you will see the start screen, with the DAG <code>esa_climate_toolbox_ops_dag</code> loaded in.
At the far right, there is a green arrow which allows to trigger the DAG.
If you then click on the name of the DAG, you are brought to a page where you can see the state of processing.
In the <code>graph</code> view, you can see the individual tasks, grouped in the task group.
If you select one of the tasks and then <code>Logs</code>, you see information on the progress.
If all tasks have finished, in your working directory there will be a file <code>airflow_plot.png</code> showing aerosol optical thickness at 550 nm over Europe on May 20th, 2002.</p><div class="myst-backmatter-parts"></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/cci-demonstrator-viewers/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-N76G4W6Y.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/root-AA24SA6C.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/_shared/chunk-AH7OE64W.js"/><link rel="modulepreload" href="/cci-demonstrator-viewers/build/routes/$-5SFLQWPV.js"/><script>window.__remixContext = {"url":"/external-notebooks/esa-cci/ect-demonstrators/demonstrators/airflow/readme","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Ect Demonstrators","level":3},{"slug":"external-notebooks.esa-cci.ect-demonstrators.readme","title":"ect-demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Demonstrators","level":4},{"title":"Airflow","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.airflow.readme","title":"Airflow Demonstrator","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"CDSE","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.matching-fire-data-with-sentinel-2-observations","title":"Matching FIRE Data with Sentinel-2 Observations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.matching-lst-data-with-a-sentinel-3-cube","title":"Matching LST Data with a Sentinel-3 Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.readme","title":"CDSE Demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"D3 Js","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.readme","title":"D3.js Demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-lc-classes","title":"Visualising Land Cover Class Change with Altair","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-visualise-uncertainties","title":"Visualizing Cloud Fraction Uncertainties with Altair and Plotly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-visualize-4d-data","title":"Visualizing 4-dimensional Data with Altair and Plotly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/cci-demonstrator-viewers"},"routes/$":{"config":{"version":3,"myst":"1.7.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Ect Demonstrators","level":3},{"slug":"external-notebooks.esa-cci.ect-demonstrators.readme","title":"ect-demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Demonstrators","level":4},{"title":"Airflow","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.airflow.readme","title":"Airflow Demonstrator","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"CDSE","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.matching-fire-data-with-sentinel-2-observations","title":"Matching FIRE Data with Sentinel-2 Observations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.matching-lst-data-with-a-sentinel-3-cube","title":"Matching LST Data with a Sentinel-3 Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.readme","title":"CDSE Demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"D3 Js","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.readme","title":"D3.js Demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-lc-classes","title":"Visualising Land Cover Class Change with Altair","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-visualise-uncertainties","title":"Visualizing Cloud Fraction Uncertainties with Altair and Plotly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-visualize-4d-data","title":"Visualizing 4-dimensional Data with Altair and Plotly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6}]}]},"page":{"version":3,"kind":"Article","sha256":"c90a7155e915b10211c7631ee55b91ac1a94fbdd21f4d7d5724b51fbbe711e60","slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.airflow.readme","location":"/external_notebooks/esa-cci/ect-demonstrators/demonstrators/Airflow/README.md","dependencies":[],"frontmatter":{"title":"Airflow Demonstrator","content_includes_title":false,"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":5}},"source_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-demonstrators/demonstrators/Airflow/README.md","edit_url":"https://github.com/esa-cci/cci-notebook-viewers/edit/main/external_notebooks/esa-cci/ect-demonstrators/demonstrators/Airflow/README.md","exports":[{"format":"md","filename":"README.md","url":"/cci-demonstrator-viewers/build/README-93bdaed669c0003db7b5f9b2df6b19c5.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This demonstrator has been tested on a Linux environment.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VJrhPeW4FC"}],"key":"BeLCPMHHL4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"It shows how Apache Airflow can be used to run a workflow including functionality from the ESA Climate Toolbox.\nAs stated on their ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RfboEM32q7"},{"type":"link","url":"https://airflow.apache.org/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"website","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wyzWlIkLJg"}],"urlSource":"https://airflow.apache.org/","key":"vfRnhLL39j"},{"type":"text","value":", Apache Airflow is a platform created by the community to programmatically author, schedule and monitor workflows.\nWorkflows are defined once and may be rerun multiple times.\nThey come in the form of Directed Acyclic Graphs (DAGs).\nFor this demonstrator, we have set up such a dag, which can be seen in the file ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W00gcOUl2C"},{"type":"inlineCode","value":"dag_config.yaml","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"riark1BX11"},{"type":"text","value":" in the dags folder.\nYou can read more about specifics of how a configuration file can be set up ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E5SH2VJ7tG"},{"type":"link","url":"https://github.com/bcdev/gaiaflow/blob/main/%7B%7B%20cookiecutter.folder_name%20%7D%7D/dags/change_me_config.yml","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rU3qXzCIZK"}],"urlSource":"https://github.com/bcdev/gaiaflow/blob/main/%7B%7B%20cookiecutter.folder_name%20%7D%7D/dags/change_me_config.yml","data":{"kind":"file","org":"bcdev","repo":"gaiaflow","reference":"main","file":"%7B%7B%20cookiecutter.folder_name%20%7D%7D/dags/change_me_config.yml","raw":"https://raw.githubusercontent.com/bcdev/gaiaflow/main/%7B%7B%20cookiecutter.folder_name%20%7D%7D/dags/change_me_config.yml"},"internal":false,"protocol":"github","key":"m71bMl5vKI"},{"type":"text","value":".\nWe explain the particularities of the DAG in the following section, if you want to run the demonstrator immediately, go to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DjbaLzQQKy"},{"type":"link","url":"(#prerequisites-to-run-the-demonstrator)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"T39SClXdgz"}],"urlSource":"(#prerequisites-to-run-the-demonstrator)","key":"efvBZjq2KH"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cHyq8hRSkE"}],"key":"Hexyj5nYbP"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The Directed Acyclic Graph (DAG)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RdbcIRBFWx"}],"identifier":"the-directed-acyclic-graph-dag","label":"The Directed Acyclic Graph (DAG)","html_id":"the-directed-acyclic-graph-dag","implicit":true,"key":"ii0FfXiSmk"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The dag is specified in the section ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"oKWtextzZY"},{"type":"inlineCode","value":"esa_climate_toolbox_ops_dag","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"d76YE7LpCy"},{"type":"text","value":". This is the name under which the dag will later be found in the UI.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BFfvI5UByE"}],"key":"yfoA7adyQ0"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"In this section, there are sub-sections ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"djHPrNEAj2"},{"type":"inlineCode","value":"task_groups","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"qbyLUCiulK"},{"type":"text","value":" and ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"qsrvQzperV"},{"type":"inlineCode","value":"tasks","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"elGyuak7c9"},{"type":"text","value":".\nTask Groups are helpful to group tasks, which can come in handy for large processes.\nHere, we only specify one group, ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"srZnij7lHE"},{"type":"inlineCode","value":"ect_tasks","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"QQS9YUOlFF"},{"type":"text","value":".\nIn ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yB3cO7zWy8"},{"type":"inlineCode","value":"tasks","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"OUu55Hh8Jg"},{"type":"text","value":", we dfine the actual sub processes.\nThere are three of them:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"qDc8jgMhh3"}],"key":"HsSTdow8oA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"chain","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"laqjdDJ25H"},{"type":"text","value":" runs a chain of ESA Climate Toolbox Operations on a dataset and writes the result to disk","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"PmEA1sNS2w"}],"key":"oliFoVWfn5"}],"key":"V8jB6f0Pwh"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"plot","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"iNbCHIQ7Rf"},{"type":"text","value":" creates a plot from this result","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FaB1Z8aZhq"}],"key":"bH0pUVKUGr"}],"key":"NPE6qsXgDt"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"delete_folder","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"m0ZURY4Mpc"},{"type":"text","value":" deletes the folder that included the data written by the ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Jt3ve3L5oH"},{"type":"inlineCode","value":"chain","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"QSxMc7oPl2"},{"type":"text","value":" task","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"jzrtUQdQWT"}],"key":"OYh7KEW8nU"}],"key":"qDMlxaZfzE"}],"key":"FKWm2HCIwM"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Tasks ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"RwyXJMEV2l"},{"type":"inlineCode","value":"chain","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"vrwzEbxEF5"},{"type":"text","value":" and ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"YlMxlsiItC"},{"type":"inlineCode","value":"plot","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"AmEw56Djp2"},{"type":"text","value":" are Python tasks - and hence use a PythonOperator - whilst ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"x4dhZlQjFc"},{"type":"inlineCode","value":"delete_folder","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"RD78ROGKCg"},{"type":"text","value":" merely executs a bash command, so it uses a ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"FYBaTd7SUu"},{"type":"inlineCode","value":"BashOperator","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"lJxDnJmyp8"},{"type":"text","value":", as can be seen in the respective task’s entries for the field ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"lAu3FMJ8rY"},{"type":"inlineCode","value":"operator","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"ktbW0lQ8rF"},{"type":"text","value":".\nBesides these, there is a large sum of operators, many of whom have been designed to cater to specific tasks (if you are interested, you can find a full list ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"aNXRJaKt1K"},{"type":"link","url":"https://registry.astronomer.io/modules?typeName=Operators\u0026_gl=1*1s3aunx*_up*MQ..*_ga*NTEyMzEyNy4xNzQ3ODMyNDM2*_ga_W97HK48NPT*czE3NDc4MzI0MzUkbzEkZzAkdDE3NDc4MzI0MzUkajAkbDAkaDA.*_ga_14DHW7X721*czE3NDc4MzI0MzUkbzEkZzAkdDE3NDc4MzI0MzUkajAkbDAkaDA.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"KFqIdMsxfM"}],"urlSource":"https://registry.astronomer.io/modules?typeName=Operators\u0026_gl=1*1s3aunx*_up*MQ..*_ga*NTEyMzEyNy4xNzQ3ODMyNDM2*_ga_W97HK48NPT*czE3NDc4MzI0MzUkbzEkZzAkdDE3NDc4MzI0MzUkajAkbDAkaDA.*_ga_14DHW7X721*czE3NDc4MzI0MzUkbzEkZzAkdDE3NDc4MzI0MzUkajAkbDAkaDA.","key":"a9NoRYR63i"},{"type":"text","value":").","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"A59dwS3NQP"}],"key":"tBG2yLcoiN"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Python operators must point to a specific Python function. This function can either be provided by a package (as is the case in the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"q6HmqyBiWm"},{"type":"inlineCode","value":"chain","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"LmUfaLyVl3"},{"type":"text","value":" task, where we point to the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"HDU6kwaIPR"},{"type":"inlineCode","value":"execute_operations","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"XrUCsg31sg"},{"type":"text","value":" function from the ESA CCI Toolbox, which allows to run multiple operations consecutively (and which is documented ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"WBfU9f1UgZ"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.core.execute_operations","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"EMdo1yO76j"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.core.execute_operations","key":"t0uosCkjdv"},{"type":"text","value":")) or as a dedicated Python function, which we did for the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nQwQuzh2hR"},{"type":"inlineCode","value":"plot","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"CeTGakWEvU"},{"type":"text","value":" task, where the function ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Akg6uoJphO"},{"type":"inlineCode","value":"plot_chain_output","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Vcnp9dVvRk"},{"type":"text","value":" is provided in the module ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"AqmIfMjZLU"},{"type":"inlineCode","value":"plot_functions.py","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"AJ9wCNtcD3"},{"type":"text","value":" in the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"jp02oC0tSx"},{"type":"inlineCode","value":"dags/functions","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Gz0yWfxUI1"},{"type":"text","value":" folder.\nNote that it would have been possible to add the plotting operation to the chain, but for the purposes of this demonstrator, we wanted to show two different approaches.\nBoth Python operators receive their parameters from the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nCYutHFR8W"},{"type":"inlineCode","value":"op_kwargs","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"LP4gBF6C2d"},{"type":"text","value":" sections in the tasks.\nFor the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"CeN7PJOT8Q"},{"type":"inlineCode","value":"chain","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"QSNmYVMcc4"},{"type":"text","value":" task, you see that we pick an aerosol dataset as input, create temporal, spatial, and thematic subsets, and ultimately write the result to an output_folder.\nThis provides a way to run ESA Climate Toolbox operations without interacting with Python directly.\nFor the ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"a8WfAMcz9s"},{"type":"inlineCode","value":"plot","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"TjtMhnuJpR"},{"type":"text","value":" task, we pick one of the variables of the dataset to plot and pick a name for the output file (for visualisation purposes, we here choose a region that is slightly larger than the subset region defined in ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"YBzD33usEm"},{"type":"inlineCode","value":"chain","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"NQkuvdVBJI"},{"type":"text","value":").\nWhat’s further of importance to point out for the tasks is that it is here where we specify the pertinence of a task to a task group (in ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"whCCUozQfY"},{"type":"inlineCode","value":"task_group_name","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"L1p7u3mf2V"},{"type":"text","value":") and define dependencies between tasks in dependencies.\nThe dependency ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZXiQf87XkH"},{"type":"inlineCode","value":"[ chain ]","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nESVmQ3nrF"},{"type":"text","value":" in ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"DYie5E8YqD"},{"type":"inlineCode","value":"plot","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"SpsW1hfH99"},{"type":"text","value":" says that the task ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"hIK3i1jHh9"},{"type":"inlineCode","value":"plot","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"mvkbEmn6iW"},{"type":"text","value":" will not start before the task ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"DrAtufl9U1"},{"type":"inlineCode","value":"chain","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ZEF5WGgu9Z"},{"type":"text","value":" has finished.\nFinally, ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"go8peOsGPD"},{"type":"inlineCode","value":"do_xcom_push","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"KydvUZbEnP"},{"type":"text","value":" is set to False, which means that no information is passed between tasks.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"GuCUfg4JK2"}],"key":"JuXP6TmZAK"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"The last task, ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"YF9a2mN5kI"},{"type":"inlineCode","value":"delete_folder","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"mvSYvyMQ2q"},{"type":"text","value":", ultimately executes the bash command which deletes the folder with the output from ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"UgfkUhUd0o"},{"type":"inlineCode","value":"chain","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"iA6tzelYh6"},{"type":"text","value":". Remove this task if you want to keep the result.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"nwPwiSRpPG"}],"key":"ifSBqJi6ey"},{"type":"heading","depth":2,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Prerequisites to run the Demonstrator","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"JDXDAxRjiA"}],"identifier":"prerequisites-to-run-the-demonstrator","label":"Prerequisites to run the Demonstrator","html_id":"prerequisites-to-run-the-demonstrator","implicit":true,"key":"Q6PsqQRLvB"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"To run this demonstrator, you need mamba (from ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"kHLlpQlmEf"},{"type":"link","url":"https://github.com/conda-forge/miniforge","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"IpfM6ISJdc"}],"urlSource":"https://github.com/conda-forge/miniforge","error":true,"key":"b9Ac8ppM78"},{"type":"text","value":"), alternatively conda.\nWhen you have mamba configured, you can create a dedicated environment using the provided file ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"TJZHtKdJpB"},{"type":"inlineCode","value":"environment.yml","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"RUsRlL0JAP"},{"type":"text","value":".\nTo do that, run","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"KpowtlFHW5"}],"key":"imLJR0VFt8"},{"type":"code","lang":"shell","value":"    mamba env create -f environment.yml","position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"key":"kHu7NIY5Cj"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"This will install all the libraries required.\nNext, export the following environment variables","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"iPeVyEW8Im"}],"key":"f08InYl9li"},{"type":"code","lang":"shell","value":"    export AIRFLOW_HOME=$(pwd)\n    export AIRFLOW__CORE__LOAD_EXAMPLES=false","position":{"start":{"line":51,"column":1},"end":{"line":54,"column":1}},"key":"MAaKAAnqsP"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"The first one will make the current folder the working directory, so that all outputs are written there.\nThe second one will prevent other dags from being loaded in, which makes it easier to keep an overview.\nNext, switch to the environment you had just created.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"lblOqOxWcr"}],"key":"KW6XaZv5v0"},{"type":"code","lang":"shell","value":"    mamba activate airflow-ect","position":{"start":{"line":58,"column":1},"end":{"line":60,"column":1}},"key":"StaWzk2edt"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"You can now run Airflow as a stand-alone server.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"i0jWOqJ8Rp"}],"key":"PA7H0qnTdW"},{"type":"code","lang":"shell","value":"    airflow standalone","position":{"start":{"line":62,"column":1},"end":{"line":64,"column":1}},"key":"xGsFtomQoG"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Running this will create a long output. In this output, you will find a username (which is admin) and a password which changes on every restart.\nAlso, this will start an airflow server available at ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"tBYlbvieQS"},{"type":"link","url":"http://0.0.0.0:8080","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"http://0.0.0.0:8080","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"gP3mQRjSh3"}],"urlSource":"http://0.0.0.0:8080","key":"sQx620eqPH"},{"type":"text","value":" .\nOpen this address in your browser, where you will be asked for the username and password.\nAfter providing the credentials, you will see the start screen, with the DAG ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"usRVyVr7M4"},{"type":"inlineCode","value":"esa_climate_toolbox_ops_dag","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"NkIouud07P"},{"type":"text","value":" loaded in.\nAt the far right, there is a green arrow which allows to trigger the DAG.\nIf you then click on the name of the DAG, you are brought to a page where you can see the state of processing.\nIn the ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"wk2mD1n6jR"},{"type":"inlineCode","value":"graph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"o824hmG9bX"},{"type":"text","value":" view, you can see the individual tasks, grouped in the task group.\nIf you select one of the tasks and then ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"gADjZRZ8k0"},{"type":"inlineCode","value":"Logs","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"NJnRkv1fDe"},{"type":"text","value":", you see information on the progress.\nIf all tasks have finished, in your working directory there will be a file ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"GBJ40xTkb9"},{"type":"inlineCode","value":"airflow_plot.png","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"SxbUEsUaVY"},{"type":"text","value":" showing aerosol optical thickness at 550 nm over Europe on May 20th, 2002.","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"TyIwakxaai"}],"key":"N13cIErTwk"}],"key":"gWfNkX6oJ0"}],"key":"Zs9t65zoVy"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ect-demonstrators","url":"/external-notebooks/esa-cci/ect-demonstrators/readme","group":"Ect Demonstrators"},"next":{"title":"Matching FIRE Data with Sentinel-2 Observations","url":"/external-notebooks/esa-cci/ect-demonstrators/demonstrators/cdse/matching-fire-data-with-sentinel-2-observations","group":"CDSE"}}},"domain":"http://localhost:3000"},"project":{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Ect Demonstrators","level":3},{"slug":"external-notebooks.esa-cci.ect-demonstrators.readme","title":"ect-demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Demonstrators","level":4},{"title":"Airflow","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.airflow.readme","title":"Airflow Demonstrator","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"CDSE","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.matching-fire-data-with-sentinel-2-observations","title":"Matching FIRE Data with Sentinel-2 Observations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.matching-lst-data-with-a-sentinel-3-cube","title":"Matching LST Data with a Sentinel-3 Cube","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.cdse.readme","title":"CDSE Demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"title":"D3 Js","level":5},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.readme","title":"D3.js Demonstrators","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-lc-classes","title":"Visualising Land Cover Class Change with Altair","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-visualise-uncertainties","title":"Visualizing Cloud Fraction Uncertainties with Altair and Plotly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6},{"slug":"external-notebooks.esa-cci.ect-demonstrators.demonstrators.d3-js.d3-js-visualize-4d-data","title":"Visualizing 4-dimensional Data with Altair and Plotly","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":6}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/cci-demonstrator-viewers/build/manifest-5D5D9E8C.js";
import * as route0 from "/cci-demonstrator-viewers/build/root-AA24SA6C.js";
import * as route1 from "/cci-demonstrator-viewers/build/routes/$-5SFLQWPV.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/cci-demonstrator-viewers/build/entry.client-PCJPW7TK.js");</script></body></html>